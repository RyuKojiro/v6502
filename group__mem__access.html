<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>v6502: Memory Access</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="logo.png"/>
<link rel="apple-touch-icon-precomposed" href="logo.png"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">v6502
   </div>
   <div id="projectbrief">The MOS 6502 Virtual Machine and Toolchain Infrastructure</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Memory Access</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga7534fd90dd9317da6779004d3acf7797"><td class="memItemLeft" align="right" valign="top"><a id="ga7534fd90dd9317da6779004d3acf7797"></a>
typedef uint8_t()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem__access.html#ga7534fd90dd9317da6779004d3acf7797">v6502_readFunction</a>(struct _v6502_memory *memory, uint16_t offset, int trap, void *context)</td></tr>
<tr class="memdesc:ga7534fd90dd9317da6779004d3acf7797"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function prototype for memory mapped accessors to be used by external virtual hardware. <br /></td></tr>
<tr class="separator:ga7534fd90dd9317da6779004d3acf7797"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga109381546a4e637df7a66bb5a41f5c7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem__access.html#ga109381546a4e637df7a66bb5a41f5c7b">v6502_map</a> (<a class="el" href="structv6502__memory.html">v6502_memory</a> *memory, uint16_t start, size_t size, <a class="el" href="group__mem__access.html#ga7534fd90dd9317da6779004d3acf7797">v6502_readFunction</a> *read, <a class="el" href="mem_8h.html#ac9633c83259528b72622b5d584019dcc">v6502_writeFunction</a> *write, void *context)</td></tr>
<tr class="memdesc:ga109381546a4e637df7a66bb5a41f5c7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map an address in <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>.  <a href="#ga109381546a4e637df7a66bb5a41f5c7b">More...</a><br /></td></tr>
<tr class="separator:ga109381546a4e637df7a66bb5a41f5c7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66910078abba377dd238370337e340db"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem__access.html#ga66910078abba377dd238370337e340db">v6502_read</a> (<a class="el" href="structv6502__memory.html">v6502_memory</a> *memory, uint16_t offset, int trap)</td></tr>
<tr class="memdesc:ga66910078abba377dd238370337e340db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a byte from <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>.  <a href="#ga66910078abba377dd238370337e340db">More...</a><br /></td></tr>
<tr class="separator:ga66910078abba377dd238370337e340db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga18b65a6dc221ab302c24e0bb2817c2c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem__access.html#ga18b65a6dc221ab302c24e0bb2817c2c1">v6502_write</a> (<a class="el" href="structv6502__memory.html">v6502_memory</a> *memory, uint16_t offset, uint8_t value)</td></tr>
<tr class="memdesc:ga18b65a6dc221ab302c24e0bb2817c2c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a byte to <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>.  <a href="#ga18b65a6dc221ab302c24e0bb2817c2c1">More...</a><br /></td></tr>
<tr class="separator:ga18b65a6dc221ab302c24e0bb2817c2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4aab780718e7a346e94aa54a846a45ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structv6502__mapped_range.html">v6502_mappedRange</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem__access.html#ga4aab780718e7a346e94aa54a846a45ee">v6502_mappedRangeForOffset</a> (<a class="el" href="structv6502__memory.html">v6502_memory</a> *memory, uint16_t offset)</td></tr>
<tr class="memdesc:ga4aab780718e7a346e94aa54a846a45ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate a <a class="el" href="structv6502__mapped_range.html" title="Memory Map Range Record. ">v6502_mappedRange</a> inside of <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>, if it exists.  <a href="#ga4aab780718e7a346e94aa54a846a45ee">More...</a><br /></td></tr>
<tr class="separator:ga4aab780718e7a346e94aa54a846a45ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga527f89359bc63964cbf183d88ecf3dfe"><td class="memItemLeft" align="right" valign="top"><a id="ga527f89359bc63964cbf183d88ecf3dfe"></a>
int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem__access.html#ga527f89359bc63964cbf183d88ecf3dfe">v6502_signedValueOfByte</a> (uint8_t byte)</td></tr>
<tr class="memdesc:ga527f89359bc63964cbf183d88ecf3dfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a raw byte to its signed value. <br /></td></tr>
<tr class="separator:ga527f89359bc63964cbf183d88ecf3dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf01d258b3d00c61cb0d3e608e0b3fa3"><td class="memItemLeft" align="right" valign="top"><a id="gaaf01d258b3d00c61cb0d3e608e0b3fa3"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mem__access.html#gaaf01d258b3d00c61cb0d3e608e0b3fa3">v6502_byteValueOfSigned</a> (int8_t i)</td></tr>
<tr class="memdesc:gaaf01d258b3d00c61cb0d3e608e0b3fa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a signed value to its raw byte. <br /></td></tr>
<tr class="separator:gaaf01d258b3d00c61cb0d3e608e0b3fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga109381546a4e637df7a66bb5a41f5c7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga109381546a4e637df7a66bb5a41f5c7b">&#9670;&nbsp;</a></span>v6502_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int v6502_map </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structv6502__memory.html">v6502_memory</a> *&#160;</td>
          <td class="paramname"><em>memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mem__access.html#ga7534fd90dd9317da6779004d3acf7797">v6502_readFunction</a> *&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mem_8h.html#ac9633c83259528b72622b5d584019dcc">v6502_writeFunction</a> *&#160;</td>
          <td class="paramname"><em>write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map an address in <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>. </p>
<p>This works by registering an v6502_memoryAccessor as the handler for that range of <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>. Anytime an access is made to that range of memory, the v6502_memoryAccessor is called instead, and is expected to return a byte ready for access. When this function is called, it is also assumed that an access is actually going to happen, which means it is safe to use calls to your callback as trap signals. This function returns YES if the mapping succeedsm, and NO if it fails. It is highly reccomended that you assert, or at least check the return code. </p>

</div>
</div>
<a id="ga4aab780718e7a346e94aa54a846a45ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4aab780718e7a346e94aa54a846a45ee">&#9670;&nbsp;</a></span>v6502_mappedRangeForOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structv6502__mapped_range.html">v6502_mappedRange</a>* v6502_mappedRangeForOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structv6502__memory.html">v6502_memory</a> *&#160;</td>
          <td class="paramname"><em>memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locate a <a class="el" href="structv6502__mapped_range.html" title="Memory Map Range Record. ">v6502_mappedRange</a> inside of <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>, if it exists. </p>
<p>This function is the slow brute force way (the original implementation) of looking up <a class="el" href="structv6502__mapped_range.html" title="Memory Map Range Record. ">v6502_mappedRange</a>'s for a given address. This function should never be hit if map caching is enabled.</p>
<p>A notable side effect of the joined mapping system is that a given range can only ever be mapped once. This means, for example, that you can't map 0xA000 through 0xB000 only for reading, and then follow it up with a map of 0xA700 through 0xB700 only for writing. It is still possible to achieve this behavior, but three map calls would be required. </p>

</div>
</div>
<a id="ga66910078abba377dd238370337e340db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga66910078abba377dd238370337e340db">&#9670;&nbsp;</a></span>v6502_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t v6502_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structv6502__memory.html">v6502_memory</a> *&#160;</td>
          <td class="paramname"><em>memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a byte from <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>. </p>
<p>All accesses made by the <a class="el" href="structv6502__cpu.html" title="Virtual CPU Object. ">v6502_cpu</a> should travel through these functions, so that they respect any hardware memory mapping. The trap argument should always be YES when accessed by the CPU, and always NO when accessed by any virtual hardware outside the CPU, or any VM construct (such as logging/introspection mechanisms.) </p>

</div>
</div>
<a id="ga18b65a6dc221ab302c24e0bb2817c2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga18b65a6dc221ab302c24e0bb2817c2c1">&#9670;&nbsp;</a></span>v6502_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void v6502_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structv6502__memory.html">v6502_memory</a> *&#160;</td>
          <td class="paramname"><em>memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a byte to <a class="el" href="structv6502__memory.html" title="Virtual Memory Object. ">v6502_memory</a>. </p>
<p>All accesses made by the <a class="el" href="structv6502__cpu.html" title="Virtual CPU Object. ">v6502_cpu</a> should travel through these functions, so that they respect any hardware memory mapping. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 9 2019 18:33:23 for v6502 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
